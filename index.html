<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>enclov-AI â€” AI-Powered GitHub PR Code Reviewer</title>
  <meta name="description" content="AI-powered PR review for GitHub using FastAPI, Celery, and GPT models." />
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; padding: 0; background: #121212; color: #e0e0e0;
      display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
      min-height: 100vh; padding: 2rem;
    }
    h1 { font-size: 3rem; color: #4caf50; text-shadow: 0 0 8px #4caf50cc; }
    h2 { font-size: 2rem; margin-top: 2rem; color: #81c784; text-shadow: 0 0 6px #81c784cc; }
    p.lead { font-size: 1.3rem; max-width: 600px; line-height: 1.6; color: #bfbfbf; margin: 1rem auto; }
    a.button {
      background-color: #4caf50; color: white; padding: 0.9em 2em; border-radius: 6px;
      font-weight: 600; font-size: 1.1rem; text-decoration: none; margin: 1rem 0;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    a.button:hover { background-color: #3a9d3a; transform: scale(1.05); cursor: pointer; }
    ul.features-list { list-style: none; padding: 0; max-width: 420px; text-align: left; }
    ul.features-list li::before { content: 'â€¢'; color: #4caf50; margin-right: 0.5em; }
    footer { margin-top: 3rem; font-size: 0.9rem; color: #666; }
    #job-progress, #comments-list, #diff-output {
      background: #1e1e1e; padding: 1rem; border-radius: 8px;
      width: 100%; max-width: 720px; margin: 1rem 0; text-align: left;
    }
    code { background: #222; padding: 0.2em 0.5em; border-radius: 3px; color: #80cbc4; }
  </style>
</head>
<body>

  <h1>enclov-AI</h1>
  <p class="lead">
    Revolutionize your GitHub PR workflow with AI-powered, automatic code reviews.  
    <code>enclov-AI</code> analyzes your diffs, spots issues, and delivers expert-level feedback â€” all within GitHub.
  </p>

  <a class="button" href="https://github.com/Web4application/enclov-AI" target="_blank">
    View on GitHub
  </a>

  <section>
    <h2>Features</h2>
    <ul class="features-list">
      <li>AI-powered review comments from OpenAI models</li>
      <li>Live GitHub Actions job monitoring</li>
      <li>Diff-based PR review summaries</li>
      <li>Built with FastAPI, Celery, Redis, and Docker</li>
      <li>Comment and workflow visibility in one dashboard</li>
    </ul>
  </section>

  <section>
    <h2>ðŸŸ¢ Live Job Progress</h2>
    <div id="job-progress">Loading latest workflow...</div>
  </section>

  <section>
    <h2>ðŸ’¬ PR Comments</h2>
    <div id="comments-list">Loading comments...</div>
  </section>

  <footer>
    &copy; 2025 enclov-AI by Kubu Lee. Built with discipline, doubt, and AI.
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    const REPO = 'Web4application/enclov-AI';
    const PR_NUMBER = 1; // Replace with dynamic value if needed

    async function fetchWorkflowStatus() {
      try {
        const res = await axios.get(`https://api.github.com/repos/${REPO}/actions/runs`);
        const latest = res.data.workflow_runs[0];
        document.getElementById('job-progress').innerHTML = `
          <strong>${latest.name}</strong><br/>
          Status: ${latest.status}<br/>
          Conclusion: ${latest.conclusion || 'Running...'}<br/>
          Run ID: ${latest.id}
        `;
      } catch (err) {
        document.getElementById('job-progress').textContent = 'Error loading job status.';
        console.error(err);
      }
    }

    async function fetchPRComments() {
      try {
        const res = await axios.get(`https://api.github.com/repos/${REPO}/pulls/${PR_NUMBER}/comments`);
        const comments = res.data;
        if (!comments.length) {
          document.getElementById('comments-list').innerHTML = '<em>No comments found yet.</em>';
          return;
        }
        document.getElementById('comments-list').innerHTML =
          comments.map(c => `<p><strong>@${c.user.login}</strong>: ${c.body}</p>`).join('');
      } catch (err) {
        document.getElementById('comments-list').textContent = 'Error loading comments.';
        console.error(err);
      }
    }

    fetchWorkflowStatus();
    fetchPRComments();
  </script>
</body>
</html>
